(() => {
  const realFetch = window.fetch.bind(window);

  window.fetch = async (input, init = {}) => {
    const url = typeof input === "string" ? input : input.url;

    if (url.includes("/api/auth/verify")) {
      console.log("[hook] intercepted:", url, init?.body);

      return new Response(JSON.stringify({ success: true }), {
        status: 200,
        headers: { "Content-Type": "application/json" },
      });
    }

    return realFetch(input, init);
  };

  console.log("[hook] fetch hooked for /api/auth/verify");
})();
// 放在 DOMContentLoaded 里最前面（仅本地测试）
const realFetch = window.fetch;
window.fetch = async (url, options) => {
  if (url === '/api/auth/init') {
    return new Response(JSON.stringify({ success: false }), {
      status: 200,
      headers: { 'Content-Type': 'application/json' }
    });
  }
  return realFetch(url, options);
};


(() => {
  const realFetch = window.fetch.bind(window);

  window.fetch = async (input, init = {}) => {
    const url = typeof input === "string" ? input : input.url;

    if (url.includes("/api/user/me?sessionId=")) {
      console.log("[hook] intercepted:", url, init?.body);

      return new Response(JSON.stringify({ role: 'admin' }), {
        status: 200,
        headers: { "Content-Type": "application/json" },
      });
    }

    return realFetch(input, init);
  };
   console.log("[hook] fetch hooked for /api/auth/verify");
})();
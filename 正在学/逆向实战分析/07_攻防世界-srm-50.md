![image-20260216051634628](https://raw.githubusercontent.com/Xioaruan912/pic/main/image-20260216051634628.png)

一个MFC 程序

![image-20260216051652495](https://raw.githubusercontent.com/Xioaruan912/pic/main/image-20260216051652495.png)

打开winmain函数

```
int __stdcall WinMain(HINSTANCE hInstance, HINSTANCE hPrevInstance, LPSTR lpCmdLine, int nShowCmd)
{
  return DialogBoxParamW(hInstance, (LPCWSTR)0x65, 0, DialogFunc, 0);
}
```

定位到`DialogFunc` 主入口

![image-20260216051723036](https://raw.githubusercontent.com/Xioaruan912/pic/main/image-20260216051723036.png)

逻辑很清晰

```
  GetDlgItemTextA(hDlg, 1001, String, 256);
  GetDlgItemTextA(hDlg, 1002, v11, 256);
  if ( strstr(String, "@") && strstr(String, ".") && strstr(String, ".")[1] && strstr(String, "@")[1] != 46 )// 分析邮箱
                                                // 
  {
  //这里设置两个字符串
    strcpy(v14, "Registration failure.");
    strcpy(Source, "Registration Success!\nYour flag is:");
   
   //关键函数分析 这里通过数组字符串设置是 CZ9dmq4c8g9G7bAX
    if ( strlen(v11) == 16
      && v11[0] == 'C'
      && v11[15] == 'X'
      && v11[1] == 'Z'
      && v11[14] == 'A'
      && v11[2] == '9'
      && v11[13] == 'b'
      && v11[3] == 'd'
      && v11[12] == '7'
      && v11[4] == 'm'
      && v11[11] == 'G'
      && v11[5] == 'q'
      && v11[10] == '9'
      && v11[6] == '4'
      && v11[9] == 'g'
      && v11[7] == 'c'
      && v11[8] == '8' )
    {
    //如果比对成功 就输出成功
      strcpy_s(Text, 0x100u, Source);
      strcat_s(Text, 0x100u, v11);
    }
    //否则失败
    else
    {
      strcpy_s(Text, 0x100u, v14);
    }
  }
  else
  {
    strcpy_s(Text, 0x100u, "Your E-mail address in not valid.");
  }
  //通过弹窗输出
  MessageBoxA(hDlg, Text, "Registeration", 0x40u);
  return 1;
}
```

直接把上述数据丢给AI就知道

```
CZ9dmq4c8g9G7bAX
```

就是FLAG了

